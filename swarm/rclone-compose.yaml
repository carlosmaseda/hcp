version: '3.6'

services:
  rclone:
    image: mumiehub/rclone-mount
    environment:
      TZ: Europe/Madrid
      MountCommands: "--allow-other --allow-non-empty --dir-cache-time 48h --poll-interval 5m --buffer-size 128M"
      RemotePath: "mediaefs:"
      MountPoint: "/mnt/mediaefs"	
      UnmountCommands: "-u -z"	
    #volumes:
      #- /path/to/config:/config
      #- /host/mount/point:/mnt/mediaefs:shared
      #- /dev/fuse:/dev/fuse
    #config:
      #- /path/to/config:/config/.rclone.conf
    cap_add:
      - NET_ADMIN
    security_opt:
      - apparmor:unconfined

#volumes:
#  haproxy_data:

--allow-other \
--read-only \
--default-permissions \
--uid 1000 \
--gid 1000 \
--umask 002 \
--acd-templink-threshold 0 \
--buffer-size 100M \
--timeout 5s \
--contimeout 5s \
--syslog \
--stats 1m \
-v \


docker run -d \
    --name rclone-mount \
    --restart=unless-stopped \
    --cap-add SYS_ADMIN \
    --device /dev/fuse \
    --security-opt apparmor:unconfined \
    -e RemotePath="alcazar:" \
    -e MountCommands="--allow-other --allow-non-empty" \
    -v rclone:/config \
    -v alcazar:/mnt/alcazar \
    mumiehub/rclone-mount
    


docker run -it --rm=true \
  --name alcazar \
  --restart=always \
  --cap-add SYS_ADMIN \
  --device /dev/fuse \
  --security-opt apparmor:unconfined \
  -v rclone:/home/pi/alcazar \
  -v rclone.conf:/root/.rclone.conf \
  tloxipeuhca/rpi-rclone \
  rclone mount alcazar: /home/pi/alcazar --checkers 16 --dir-cache-time 30m -vv --allow-other --allow-non-empty --dir-cache-time 48h --poll-interval 5m --buffer-size 128M
